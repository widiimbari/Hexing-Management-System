generator client {
  provider = "prisma-client-js"
  output   = "../generated/management-client-v2"
}

datasource db {
  provider = "postgresql"
  url      = env("MANAGEMENT_DATABASE_URL")
}

model users {
  id        Int     @id @default(autoincrement())
  username  String  @unique @db.VarChar(255)
  password  String  @db.VarChar(255)
  role      String  @db.VarChar(100)
  name      String? @db.VarChar(255)
  image_url String? @db.Text
}

model system_logs {
  id          BigInt   @id @default(autoincrement())
  module      String   @db.VarChar(50)  // ASSET, INVENTORY, WAREHOUSE, USER
  action      String   @db.VarChar(50)  // CREATE, UPDATE, DELETE, LOGIN, LOGOUT, EXPORT, IMPORT
  entity_type String   @db.VarChar(100) // Asset, Employee, Category, Product, Attachment
  entity_id   String?  @db.VarChar(255) // ID of affected entity
  description String?  @db.Text         // Human readable description
  old_values  Json?                      // Previous values (for UPDATE/DELETE)
  new_values  Json?                      // New values (for CREATE/UPDATE)
  user_id     Int?                       // User who performed action
  user_name   String?  @db.VarChar(255)  // Username for quick display
  ip_address  String?  @db.VarChar(45)
  user_agent  String?  @db.VarChar(500)
  created_at  DateTime @default(now()) @db.Timestamp(0)

  @@index([module])
  @@index([action])
  @@index([entity_type])
  @@index([user_id])
  @@index([created_at])
  @@index([module, created_at])
}
